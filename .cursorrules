# CURSOR RULES - Nina 1.0

## WORKFLOW OBRIGAT√ìRIO: Planner ‚Üí Worker ‚Üí Orchestrator

**SEMPRE siga este workflow ao implementar features novas ou fazer mudan√ßas significativas no c√≥digo.**

### ‚ö†Ô∏è IMPORTANTE: SELE√á√ÉO DE MODELO

**O Cursor N√ÉO seleciona modelos automaticamente.** O usu√°rio precisa selecionar manualmente o modelo no chat do Cursor em cada etapa:

- **ETAPA 1 (Planner):** Usu√°rio deve selecionar **Opus 4.5** manualmente
- **ETAPA 2 (Worker):** Usu√°rio deve selecionar **Haiku 4.5** manualmente  
- **ETAPA 3 (Orchestrator):** Usu√°rio deve selecionar **Opus 4.5** manualmente

**O assistente DEVE avisar qual modelo usar em cada etapa antes de prosseguir.**

### FLUXO DO WORKFLOW

```
1. PLANNER (modelo mais caro - Opus 4.5) ‚Üí Cria especifica√ß√£o t√©cnica
   ‚Üì
2. WORKER (modelo mais barato - Haiku 4.5) ‚Üí Gera c√≥digo baseado na especifica√ß√£o
   ‚Üì
3. ORCHESTRATOR (mesmo Planner - Opus 4.5) ‚Üí Analisa e aprova/rejeita o c√≥digo
   ‚Üì
4a. APROVADO ‚Üí Implementa o c√≥digo
4b. REJEITADO ‚Üí Feedback intermedi√°rio ‚Üí Volta para WORKER
```

### ETAPA 1: PLANNER (Modelo Mais Caro - Opus 4.5)

Quando o usu√°rio pedir para implementar uma feature nova:

1. **AVISE O USU√ÅRIO:** "üîµ **ATEN√á√ÉO:** Por favor, selecione o modelo **Opus 4.5** no seletor de modelos do chat do Cursor antes de continuar. Vou criar a especifica√ß√£o t√©cnica."
2. **NUNCA v√° direto para c√≥digo** - Sempre crie uma especifica√ß√£o primeiro
3. **Use modelo mais caro** (Opus 4.5) para criar especifica√ß√£o detalhada
3. **Crie especifica√ß√£o t√©cnica completa:**
   ```markdown
   ## üìã ESPECIFICA√á√ÉO T√âCNICA
   
   ### 1. TAREFA PRINCIPAL
   [Uma frase descrevendo o que ser√° implementado]
   
   ### 2. REQUISITOS FUNCIONAIS
   - [ ] Requisito 1
   - [ ] Requisito 2
   - [ ] Requisito 3
   
   ### 3. REQUISITOS N√ÉO-FUNCIONAIS
   - [ ] Performance: [especifica√ß√µes]
   - [ ] Seguran√ßa: [especifica√ß√µes]
   - [ ] Manutenibilidade: [especifica√ß√µes]
   
   ### 4. ARQUIVOS A CRIAR/MODIFICAR
   - `src/path/to/file1.tsx` - [descri√ß√£o]
   - `src/path/to/file2.tsx` - [descri√ß√£o]
   
   ### 5. RESTRI√á√ïES E CONSIDERA√á√ïES
   - [Restri√ß√£o 1]
   - [Restri√ß√£o 2]
   
   ### 6. DEPEND√äNCIAS
   - [Depend√™ncia 1]
   - [Depend√™ncia 2]
   
   ### 7. TESTES NECESS√ÅRIOS
   - [ ] Teste 1
   - [ ] Teste 2
   ```
4. **Salve a especifica√ß√£o** em `.cursor/specs/[nome-da-tarefa].md`
5. **Aguarde aprova√ß√£o do usu√°rio** antes de passar para o Worker

### ETAPA 2: WORKER (Modelo Mais Barato - Haiku 4.5)

Ap√≥s a especifica√ß√£o ser aprovada:

1. **AVISE O USU√ÅRIO:** "üü¢ **ATEN√á√ÉO:** Por favor, selecione o modelo **Haiku 4.5** no seletor de modelos do chat do Cursor. Vou fornecer o prompt completo do Worker para voc√™ colar."
2. **Forne√ßa o prompt completo** do Worker baseado em `.cursor/workflows/worker-prompt.md`, incluindo:
   - A tarefa
   - O contexto do projeto
   - A especifica√ß√£o completa (leia de `.cursor/specs/[nome-da-tarefa].md`)
   - Instru√ß√µes para o Worker
3. **Aguarde o Worker gerar c√≥digo** usando Haiku 4.5 (o usu√°rio vai colar o prompt e o Haiku vai responder)
4. **Leia a especifica√ß√£o** do arquivo `.cursor/specs/[nome-da-tarefa].md`
3. **Gere c√≥digo seguindo EXATAMENTE a especifica√ß√£o:**
   - N√£o adicione features extras
   - N√£o remova requisitos
   - Siga todos os arquivos listados
   - Respeite todas as restri√ß√µes
5. **Formate a sugest√£o assim:**
   ```markdown
   ## üìù C√ìDIGO GERADO
   
   ### Baseado na especifica√ß√£o: [nome-da-tarefa].md
   
   ### Arquivos Implementados:
   - `src/path/to/file1.tsx` - [descri√ß√£o]
   - `src/path/to/file2.tsx` - [descri√ß√£o]
   
   ### C√≥digo:
   \`\`\`typescript
   [c√≥digo gerado aqui]
   \`\`\`
   
   ### Explica√ß√£o:
   [breve explica√ß√£o da implementa√ß√£o]
   ```
6. **Pe√ßa para salvar** a sugest√£o em `.cursor/suggestions/[nome-da-tarefa].md`
7. **Aguarde an√°lise do Orchestrator**

### ETAPA 3: ORCHESTRATOR (Mesmo Planner - Opus 4.5)

Ap√≥s o Worker gerar c√≥digo:

1. **AVISE O USU√ÅRIO:** "üîµ **ATEN√á√ÉO:** Por favor, selecione o modelo **Opus 4.5** no seletor de modelos do chat do Cursor para an√°lise do Orchestrator."
2. **Use o mesmo modelo do Planner** (Opus 4.5) para an√°lise rigorosa
3. **Compare c√≥digo gerado com especifica√ß√£o original:**
   - Leia `.cursor/specs/[nome-da-tarefa].md` (especifica√ß√£o)
   - Leia `.cursor/suggestions/[nome-da-tarefa].md` (c√≥digo gerado)
4. **Checklist de aprova√ß√£o:**
   - ‚úÖ O c√≥digo implementa TODOS os requisitos funcionais?
   - ‚úÖ Respeita TODAS as restri√ß√µes?
   - ‚úÖ Os arquivos corretos foram criados/modificados?
   - ‚úÖ Segue padr√µes do codebase?
   - ‚úÖ C√≥digo limpo e leg√≠vel?
   - ‚úÖ TypeScript com tipagem forte?
   - ‚úÖ N√£o exp√µe dados sens√≠veis?
   - ‚úÖ Valida inputs adequadamente?
   - ‚úÖ Trata erros corretamente?
   - ‚úÖ N√£o quebra funcionalidades existentes?
   - ‚úÖ Performance adequada?
5. **Formate a an√°lise assim:**
   ```markdown
   ## ‚úÖ AN√ÅLISE DO ORCHESTRATOR
   
   **Especifica√ß√£o:** [nome-da-tarefa].md
   **C√≥digo gerado:** [nome-da-tarefa].md
   
   **APROVA√á√ÉO:** [ ] ‚úÖ APROVADO [ ] ‚ùå REJEITADO
   **SCORE:** [0-100]/100
   
   ### Conformidade com Especifica√ß√£o:
   - [ ] Todos os requisitos funcionais implementados
   - [ ] Todas as restri√ß√µes respeitadas
   - [ ] Arquivos corretos criados/modificados
   
   ### Qualidade de C√≥digo:
   - [ ] Segue padr√µes do codebase
   - [ ] C√≥digo limpo e leg√≠vel
   - [ ] TypeScript correto
   
   ### Seguran√ßa e Boas Pr√°ticas:
   - [ ] N√£o exp√µe dados sens√≠veis
   - [ ] Valida inputs
   - [ ] Trata erros
   
   ### Pontos Fortes:
   - [lista]
   
   ### Problemas Encontrados:
   - [lista detalhada]
   
   ### Feedback para Worker:
   [Se REJEITADO: feedback espec√≠fico e construtivo para corre√ß√£o]
   ```
6. **Se APROVADO:** C√≥digo pode ser implementado
7. **Se REJEITADO:** Criar feedback intermedi√°rio e voltar para Worker

### ETAPA 4: FEEDBACK INTERMEDI√ÅRIO (Se Rejeitado)

Quando o Orchestrator rejeitar:

1. **Crie documento de feedback:**
   ```markdown
   ## üîÑ FEEDBACK PARA WORKER
   
   **Especifica√ß√£o original:** [nome-da-tarefa].md
   **An√°lise do Orchestrator:** [score e motivos]
   
   ### O que precisa ser corrigido:
   1. [Problema 1 - descri√ß√£o detalhada]
   2. [Problema 2 - descri√ß√£o detalhada]
   
   ### Sugest√µes espec√≠ficas:
   - [Sugest√£o 1]
   - [Sugest√£o 2]
   
   ### Arquivos que precisam de revis√£o:
   - `src/path/to/file1.tsx` - [motivo]
   - `src/path/to/file2.tsx` - [motivo]
   ```
2. **Salve feedback** em `.cursor/feedback/[nome-da-tarefa]-feedback.md`
3. **AVISE O USU√ÅRIO:** "üü¢ **ATEN√á√ÉO:** Por favor, selecione o modelo **Haiku 4.5** novamente. Vou fornecer o feedback para o Worker corrigir."
4. **Volte para ETAPA 2 (Worker)** com o feedback
5. **Worker revisa e gera novo c√≥digo** baseado no feedback
6. **Repete at√© aprova√ß√£o**

### EXCE√á√ïES (Quando pode pular o workflow)

Voc√™ pode pular o workflow apenas para:
- Corre√ß√µes de bugs simples (typos, erros de sintaxe)
- Refatora√ß√µes menores (renomear vari√°veis, formatar c√≥digo)
- Ajustes de estilo/UI menores
- Comandos de terminal/scripts simples

**Para tudo mais:** Use o workflow completo Planner ‚Üí Worker ‚Üí Orchestrator

### ECONOMIA DE TOKENS

- **Planner (Opus 4.5):** ~2k tokens (1x) - Cria especifica√ß√£o
- **Worker (Haiku 4.5):** ~1k tokens por itera√ß√£o - Gera c√≥digo (Muito r√°pido e barato)
- **Orchestrator (Opus 4.5):** ~2k tokens por an√°lise - Valida c√≥digo
- **Total t√≠pico:** ~5k tokens (vs ~30k+ sem workflow)

**Economia:** ~83% de tokens!

---

## PADR√ïES DO PROJETO

### Stack e Tecnologias
- **Frontend:** Next.js 15, React 18, TypeScript
- **Backend:** Firebase (Firestore + Auth)
- **UI:** Tailwind CSS, shadcn/ui
- **Valida√ß√£o:** Zod
- **Data:** date-fns
- **Charts:** Recharts

### Estrutura de Pastas
- `src/app/` - P√°ginas Next.js
- `src/components/` - Componentes React
- `src/components/ui/` - Componentes shadcn/ui
- `src/hooks/` - Hooks customizados
- `src/lib/` - Utilit√°rios e tipos
- `src/firebase/` - Configura√ß√£o Firebase
- `functions/src/` - Cloud Functions
- `.cursor/specs/` - Especifica√ß√µes t√©cnicas
- `.cursor/suggestions/` - C√≥digo gerado pelo Worker
- `.cursor/feedback/` - Feedback intermedi√°rio

### Conven√ß√µes de C√≥digo
- **Componentes:** PascalCase, arquivos `.tsx`
- **Hooks:** camelCase com prefixo `use`, arquivos `.ts` ou `.tsx`
- **Utils:** camelCase, arquivos `.ts`
- **Tipos:** PascalCase, definidos em `src/lib/types.ts` ou inline
- **Imports:** Agrupar por tipo (React, libs, componentes, utils, tipos)

### Padr√µes React
- Usar hooks customizados quando apropriado
- `useMemo` para c√°lculos pesados
- `useCallback` para fun√ß√µes passadas como props
- Early returns para valida√ß√µes
- Tratamento de erros expl√≠cito

### Padr√µes Firebase
- Usar hooks customizados (`useCollection`, `useDoc`)
- Valida√ß√£o de dados antes de salvar
- Soft delete: marcar como `_isDeleted: true` ao inv√©s de deletar
- Filtrar usu√°rios deletados em todas as queries

### Seguran√ßa
- Nunca expor dados sens√≠veis (tokens, senhas, keys)
- Validar inputs do usu√°rio
- Respeitar regras de autentica√ß√£o/autoriza√ß√£o
- Usar vari√°veis de ambiente para configs sens√≠veis

### UI/UX
- Cor prim√°ria: `hsl(170, 60%, 50%)`
- Usar componentes shadcn/ui
- Loading states com Skeleton
- Feedback com Toast
- Tooltips para informa√ß√µes adicionais

---

## REGRAS GERAIS

1. **Sempre responder em Portugu√™s**
2. **Priorizar seguran√ßa, depois corretude, depois performance**
3. **C√≥digo limpo e leg√≠vel** - KISS e SOLID light
4. **Tipagem forte** - TypeScript estrito
5. **Documenta√ß√£o m√≠nima** - Apenas quando necess√°rio
6. **Testes proporcionais ao risco** - N√£o precisa 100% de cobertura
7. **Commits at√¥micos** - Uma feature por commit
8. **Nunca commitar segredos** - Sempre usar .env

---

## CONTEXTO DO PROJETO

**Nina 1.0** - Plataforma de Gest√£o de Lideran√ßa para 3A RIVA Investimentos

**Funcionalidades principais:**
- Autentica√ß√£o Google (apenas @3ainvestimentos.com.br)
- Dashboard de Lideran√ßa com ranking e hist√≥rico
- Acompanhamento Individual de colaboradores
- Gerenciamento de PDI (Planos de Desenvolvimento Individual)
- An√°lise de Risco dos colaboradores
- Gerenciamento de Projetos
- Painel Admin para configura√ß√µes

**Roles:** Colaborador, L√≠der, Diretor, Admin
**Acesso:** Apenas L√≠der, Diretor e Admin podem acessar o dashboard

